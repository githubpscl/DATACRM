(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4972],{899:function(e,r,n){Promise.resolve().then(n.bind(n,591))},591:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return Z}});var a=n(7437),t=n(7182),s=n(9376),i=n(2265),l=n(9820),d=n(2381),c=n(279),o=n(5060),m=n(3448);let u=i.forwardRef((e,r)=>{let{className:n,...t}=e;return(0,a.jsx)("textarea",{className:(0,m.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:r,...t})});u.displayName="Textarea";var f=n(9174),x=n(5937),g=n(8420),h=n(2660),b=n(5302),v=n(1723),j=n(2252),p=n(7806),N=n(6362),y=n(4743),w=n(9345),k=n(8906),S=n(5526);function Z(){let{user:e,loading:r,logout:n}=(0,t.a)(),m=(0,s.useRouter)(),[Z,z]=(0,i.useState)([]),[A,E]=(0,i.useState)([]),[C,O]=(0,i.useState)(null),[F,_]=(0,i.useState)(""),[R,B]=(0,i.useState)(!1),[I,M]=(0,i.useState)(!0),[D,V]=(0,i.useState)(!1),[Y,H]=(0,i.useState)({organizationName:"",adminEmail:"",message:""}),[T,K]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let r=async()=>{if(e)try{var r;if("super_admin"===e.role||e.organizationId&&(null===(r=e.organization)||void 0===r?void 0:r.id)){console.log("User already has organization, redirecting to dashboard"),m.push("/dashboard");return}let n=await (0,S._b)();n.data&&z(n.data);let a=await (0,S.H$)();a.data&&E(a.data)}catch(e){console.error("Error checking organization status:",e)}finally{M(!1)}};e&&r()},[e,m]);let U=async()=>{if(!C){alert("Bitte w\xe4hlen Sie eine Organisation aus.");return}B(!0);try{let r=await (0,S.X3)({organization_id:C.id,admin_email:"admin@"+C.name.toLowerCase().replace(/\s+/g,"")+".com",message:F.trim()||void 0});if(r.data){alert("Beitrittsanfrage erfolgreich gesendet!");let e=await (0,S.H$)();e.data&&E(e.data),O(null),_("")}else{var e;alert("Fehler beim Senden der Anfrage: "+("string"==typeof r.error?r.error:(null===(e=r.error)||void 0===e?void 0:e.message)||"Unbekannter Fehler"))}}catch(e){console.error("Error creating join request:",e),alert("Fehler beim Senden der Anfrage")}finally{B(!1)}},W=async()=>{if(!Y.organizationName.trim()||!Y.adminEmail.trim()||!Y.message.trim()){alert("Bitte f\xfcllen Sie alle Felder aus.");return}B(!0);try{let r="\nVon: ".concat(null==e?void 0:e.email,"\nAn: ").concat(Y.adminEmail,'\nBetreff: Bitte um Aufnahme in Organisation "').concat(Y.organizationName,'"\n\nHallo,\n\nich w\xfcrde gerne der Organisation "').concat(Y.organizationName,'" beitreten.\n\n').concat(Y.message,"\n\nMeine Daten:\n- E-Mail: ").concat(null==e?void 0:e.email,"\n- Name: ").concat(null==e?void 0:e.firstName," ").concat(null==e?void 0:e.lastName,"\n\nVielen Dank!\n\nMit freundlichen Gr\xfc\xdfen\n").concat(null==e?void 0:e.firstName," ").concat(null==e?void 0:e.lastName,"\n      ");console.log("Email w\xfcrde gesendet werden:",r),H({organizationName:"",adminEmail:"",message:""}),K(!0),V(!1),setTimeout(()=>K(!1),5e3)}catch(e){console.error("Error sending contact email:",e),alert("Fehler beim Senden der E-Mail")}finally{B(!1)}};return r||I?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Organisationsstatus wird \xfcberpr\xfcft..."})]})}):e?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"max-w-4xl w-full space-y-8",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(g.Z,{className:"h-16 w-16 text-blue-600 mx-auto mb-4"}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Organisation erforderlich"}),(0,a.jsx)("p",{className:"text-gray-600 max-w-2xl mx-auto mb-4",children:"Um das CRM zu nutzen, m\xfcssen Sie einer Organisation angeh\xf6ren. Sie k\xf6nnen einer bestehenden Organisation beitreten oder einen Administrator kontaktieren."}),(0,a.jsx)("div",{className:"flex justify-center space-x-4",children:(0,a.jsxs)(d.z,{variant:"outline",onClick:()=>n(),children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),"Abmelden"]})})]}),T&&(0,a.jsxs)(x.bZ,{children:[(0,a.jsx)(b.Z,{className:"h-4 w-4"}),(0,a.jsx)(x.X,{children:"Ihre Nachricht wurde erfolgreich versendet! Der Administrator wird sich mit Ihnen in Verbindung setzen."})]}),A.length>0&&(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(v.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Ihre Beitrittsanfragen"})]}),(0,a.jsx)(l.SZ,{children:"Status Ihrer eingereichten Beitrittsanfragen"})]}),(0,a.jsx)(l.aY,{children:(0,a.jsx)("div",{className:"space-y-3",children:A.map(e=>{var r;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:null===(r=e.organization)||void 0===r?void 0:r.name}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["Angefragt am ",new Date(e.requested_at).toLocaleDateString("de-DE")]}),e.message&&(0,a.jsxs)("div",{className:"text-sm text-gray-500 mt-1",children:['Nachricht: "',e.message,'"']})]}),(0,a.jsxs)(f.C,{variant:"approved"===e.status?"default":"rejected"===e.status?"destructive":"secondary",children:["pending"===e.status&&(0,a.jsx)(v.Z,{className:"h-3 w-3 mr-1"}),"approved"===e.status&&(0,a.jsx)(b.Z,{className:"h-3 w-3 mr-1"}),"rejected"===e.status&&(0,a.jsx)(j.Z,{className:"h-3 w-3 mr-1"}),"pending"===e.status?"Ausstehend":"approved"===e.status?"Genehmigt":"Abgelehnt"]})]},e.id)})})})]}),!D&&(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(p.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Einer Organisation beitreten"})]}),(0,a.jsx)(l.SZ,{children:"W\xe4hlen Sie eine Organisation und senden Sie eine Beitrittsanfrage"})]}),(0,a.jsx)(l.aY,{className:"space-y-6",children:Z.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Z.map(e=>(0,a.jsxs)("div",{className:"p-4 border rounded-lg cursor-pointer transition-colors ".concat((null==C?void 0:C.id)===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),onClick:()=>O(e),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsx)(g.Z,{className:"h-5 w-5 text-gray-500 flex-shrink-0 mt-0.5"}),e.website&&(0,a.jsx)(N.Z,{className:"h-4 w-4 text-gray-400"})]}),(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-1",children:e.name}),e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),e.industry&&(0,a.jsx)(f.C,{variant:"outline",className:"text-xs",children:e.industry})]},e.id))}),C&&(0,a.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,a.jsxs)("h3",{className:"font-medium text-gray-900",children:['Beitrittsanfrage f\xfcr "',C.name,'"']}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o._,{htmlFor:"message",children:"Nachricht (optional)"}),(0,a.jsx)(u,{id:"message",value:F,onChange:e=>_(e.target.value),placeholder:"Kurze Beschreibung, warum Sie dieser Organisation beitreten m\xf6chten...",className:"mt-1",rows:3})]}),(0,a.jsx)(d.z,{onClick:U,disabled:R,className:"w-full",children:R?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Anfrage wird gesendet..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.Z,{className:"h-4 w-4 mr-2"}),"Beitrittsanfrage senden"]})})]})]}):(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(g.Z,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("p",{className:"mb-2",children:"Keine verf\xfcgbaren Organisationen gefunden."}),(0,a.jsx)("p",{className:"text-sm",children:"Alle verf\xfcgbaren Organisationen wurden bereits angefragt oder Sie sind bereits Mitglied."})]})})]}),D?(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(w.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Administrator kontaktieren"})]}),(0,a.jsx)(l.SZ,{children:"Senden Sie eine E-Mail an einen Administrator, um Ihrer Organisation beizutreten"})]}),(0,a.jsxs)(l.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o._,{htmlFor:"orgName",children:"Name der Organisation"}),(0,a.jsx)(c.I,{id:"orgName",value:Y.organizationName,onChange:e=>H({...Y,organizationName:e.target.value}),placeholder:"Firmenname oder Organisationsname",className:"mt-1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o._,{htmlFor:"adminEmail",children:"Administrator E-Mail"}),(0,a.jsx)(c.I,{id:"adminEmail",type:"email",value:Y.adminEmail,onChange:e=>H({...Y,adminEmail:e.target.value}),placeholder:"admin@firma.de",className:"mt-1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o._,{htmlFor:"contactMessage",children:"Nachricht"}),(0,a.jsx)(u,{id:"contactMessage",value:Y.message,onChange:e=>H({...Y,message:e.target.value}),placeholder:"Beschreiben Sie, warum Sie der Organisation beitreten m\xf6chten...",className:"mt-1",rows:4})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)(d.z,{onClick:W,disabled:R||!Y.organizationName.trim()||!Y.adminEmail.trim()||!Y.message.trim(),className:"flex-1",children:R?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"E-Mail wird gesendet..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.Z,{className:"h-4 w-4 mr-2"}),"E-Mail senden"]})}),(0,a.jsx)(d.z,{variant:"outline",onClick:()=>V(!1),disabled:R,children:"Abbrechen"})]})]})]}):(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"flex items-center space-x-2",children:[(0,a.jsx)(w.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Alternative: Administrator kontaktieren"})]}),(0,a.jsx)(l.SZ,{children:"Falls Ihre Organisation nicht aufgelistet ist, kontaktieren Sie direkt einen Administrator"})]}),(0,a.jsx)(l.aY,{children:(0,a.jsxs)(d.z,{variant:"outline",onClick:()=>V(!0),className:"w-full",children:[(0,a.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),"Administrator per E-Mail kontaktieren"]})})]}),(0,a.jsx)(l.Zb,{className:"border-blue-200 bg-blue-50",children:(0,a.jsx)(l.aY,{className:"pt-6",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(k.Z,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("h4",{className:"font-medium text-blue-900 mb-1",children:"Hilfe ben\xf6tigt?"}),(0,a.jsx)("p",{className:"text-blue-800 mb-2",children:"Falls Sie Probleme beim Beitreten haben oder Ihre Organisation nicht finden:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside text-blue-700 space-y-1",children:[(0,a.jsx)("li",{children:"Kontaktieren Sie Ihren IT-Administrator"}),(0,a.jsx)("li",{children:"Wenden Sie sich an den DataCRM Support"}),(0,a.jsx)("li",{children:"Bitten Sie einen bestehenden Administrator, Sie hinzuzuf\xfcgen"})]})]})]})})})]})}):(m.push("/login"),null)}},5937:function(e,r,n){"use strict";n.d(r,{X:function(){return c},bZ:function(){return d}});var a=n(7437),t=n(2265),s=n(535),i=n(3448);let l=(0,s.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=t.forwardRef((e,r)=>{let{className:n,variant:t,...s}=e;return(0,a.jsx)("div",{ref:r,role:"alert",className:(0,i.cn)(l({variant:t}),n),...s})});d.displayName="Alert",t.forwardRef((e,r)=>{let{className:n,...t}=e;return(0,a.jsx)("h5",{ref:r,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",n),...t})}).displayName="AlertTitle";let c=t.forwardRef((e,r)=>{let{className:n,...t}=e;return(0,a.jsx)("div",{ref:r,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",n),...t})});c.displayName="AlertDescription"},9174:function(e,r,n){"use strict";n.d(r,{C:function(){return l}});var a=n(7437);n(2265);var t=n(535),s=n(3448);let i=(0,t.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:r,variant:n,...t}=e;return(0,a.jsx)("div",{className:(0,s.cn)(i({variant:n}),r),...t})}},2381:function(e,r,n){"use strict";n.d(r,{z:function(){return c}});var a=n(7437),t=n(2265),s=n(7053),i=n(535),l=n(3448);let d=(0,i.j)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=t.forwardRef((e,r)=>{let{className:n,variant:t,size:i,asChild:c=!1,...o}=e,m=c?s.g7:"button";return(0,a.jsx)(m,{className:(0,l.cn)(d({variant:t,size:i,className:n})),ref:r,...o})});c.displayName="Button"},9820:function(e,r,n){"use strict";n.d(r,{Ol:function(){return l},SZ:function(){return c},Zb:function(){return i},aY:function(){return o},ll:function(){return d}});var a=n(7437),t=n(2265),s=n(3448);let i=t.forwardRef((e,r)=>{let{className:n,...t}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",n),...t})});i.displayName="Card";let l=t.forwardRef((e,r)=>{let{className:n,...t}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",n),...t})});l.displayName="CardHeader";let d=t.forwardRef((e,r)=>{let{className:n,...t}=e;return(0,a.jsx)("h3",{ref:r,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",n),...t})});d.displayName="CardTitle";let c=t.forwardRef((e,r)=>{let{className:n,...t}=e;return(0,a.jsx)("p",{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",n),...t})});c.displayName="CardDescription";let o=t.forwardRef((e,r)=>{let{className:n,...t}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("p-6 pt-0",n),...t})});o.displayName="CardContent",t.forwardRef((e,r)=>{let{className:n,...t}=e;return(0,a.jsx)("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",n),...t})}).displayName="CardFooter"},279:function(e,r,n){"use strict";n.d(r,{I:function(){return i}});var a=n(7437),t=n(2265),s=n(3448);let i=t.forwardRef((e,r)=>{let{className:n,type:t,...i}=e;return(0,a.jsx)("input",{type:t,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:r,...i})});i.displayName="Input"},5060:function(e,r,n){"use strict";n.d(r,{_:function(){return c}});var a=n(7437),t=n(2265),s=n(6394),i=n(535),l=n(3448);let d=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=t.forwardRef((e,r)=>{let{className:n,...t}=e;return(0,a.jsx)(s.f,{ref:r,className:(0,l.cn)(d(),n),...t})});c.displayName=s.f.displayName},3448:function(e,r,n){"use strict";n.d(r,{cn:function(){return s}});var a=n(1994),t=n(3335);function s(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return(0,t.m6)((0,a.W)(r))}}},function(e){e.O(0,[1216,7182,1744],function(){return e(e.s=899)}),_N_E=e.O()}]);
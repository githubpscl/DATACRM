"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6375],{6375:function(e,t,a){a.d(t,{Z:function(){return z}});var r=a(7437),s=a(2265),n=a(9376),i=a(7182),o=a(8728),l=a(2369),d=a(4766),c=a(2805),m=a(112),u=a(7692);function h(){let[e,t]=(0,s.useState)(!1),a=(0,s.useRef)(null),{user:h,logout:f}=(0,i.a)(),x=(0,n.useRouter)();(0,s.useEffect)(()=>{function e(e){a.current&&!a.current.contains(e.target)&&t(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let b=()=>(null==h?void 0:h.firstName)&&(null==h?void 0:h.lastName)?"".concat(h.firstName.charAt(0)).concat(h.lastName.charAt(0)).toUpperCase():(null==h?void 0:h.firstName)?h.firstName.charAt(0).toUpperCase():(null==h?void 0:h.email)?h.email.substring(0,2).toUpperCase():"U",g=async()=>{t(!1),await f()},p=e=>{t(!1),x.push(e)};return h?(0,r.jsxs)("div",{className:"relative",ref:a,children:[(0,r.jsx)("button",{onClick:()=>t(!e),className:"flex items-center justify-center w-9 h-9 bg-blue-600 text-white rounded-full text-sm font-medium hover:bg-blue-700 transition-all duration-200 hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transform hover:scale-105",children:b()}),e&&(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-72 bg-white rounded-xl shadow-xl border border-gray-200 py-2 z-50 animate-in slide-in-from-top-2 duration-200",children:[(0,r.jsx)("div",{className:"px-4 py-4 border-b border-gray-100",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-12 h-12 bg-blue-600 text-white rounded-full text-sm font-medium",children:b()}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-900 truncate",children:(null==h?void 0:h.firstName)&&(null==h?void 0:h.lastName)?"".concat(h.firstName," ").concat(h.lastName):(null==h?void 0:h.firstName)?h.firstName:(null==h?void 0:h.email)?h.email.split("@")[0]:"Benutzer"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 truncate",children:h.email}),(0,r.jsx)("div",{className:"mt-1",children:(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Online"})})]})]})}),(0,r.jsxs)("div",{className:"py-2",children:[(0,r.jsxs)("button",{onClick:()=>p("/dashboard/settings"),className:"flex items-center w-full px-4 py-2.5 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-700 transition-colors",children:[(0,r.jsx)(o.Z,{className:"mr-3 h-4 w-4 text-gray-400"}),"Einstellungen"]}),(0,r.jsxs)("button",{onClick:()=>p("/dashboard/settings/profile"),className:"flex items-center w-full px-4 py-2.5 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-700 transition-colors",children:[(0,r.jsx)(l.Z,{className:"mr-3 h-4 w-4 text-gray-400"}),"Profil bearbeiten"]}),(0,r.jsxs)("button",{onClick:()=>p("/dashboard/settings/notifications"),className:"flex items-center w-full px-4 py-2.5 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-700 transition-colors",children:[(0,r.jsx)(d.Z,{className:"mr-3 h-4 w-4 text-gray-400"}),"Benachrichtigungen"]}),(0,r.jsxs)("button",{onClick:()=>p("/dashboard/settings/appearance"),className:"flex items-center w-full px-4 py-2.5 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-700 transition-colors",children:[(0,r.jsx)(c.Z,{className:"mr-3 h-4 w-4 text-gray-400"}),"Darstellung"]}),(0,r.jsx)("div",{className:"border-t border-gray-100 my-2"}),(0,r.jsxs)("button",{onClick:()=>p("/help"),className:"flex items-center w-full px-4 py-2.5 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-700 transition-colors",children:[(0,r.jsx)(m.Z,{className:"mr-3 h-4 w-4 text-gray-400"}),"Hilfe & Support"]}),(0,r.jsx)("div",{className:"border-t border-gray-100 my-2"}),(0,r.jsxs)("button",{onClick:g,className:"flex items-center w-full px-4 py-2.5 text-sm text-red-600 hover:bg-red-50 hover:text-red-700 transition-colors",children:[(0,r.jsx)(u.Z,{className:"mr-3 h-4 w-4 text-red-500"}),"Abmelden"]})]})]})]}):null}var f=a(9820),x=a(9174),b=a(3639),g=a(1723),p=a(5302);function v(){let{user:e}=(0,i.a)(),[t,a]=(0,s.useState)(6e5),[n,o]=(0,s.useState)(!1),[l,d]=(0,s.useState)(Date.now());if((0,s.useEffect)(()=>{if(!e)return;let t=()=>{d(Date.now()),o(!1)},r=["mousedown","mousemove","keypress","scroll","touchstart","click"];r.forEach(e=>{document.addEventListener(e,t,{passive:!0})});let s=setInterval(()=>{let e=6e5-(Date.now()-l);a(e),o(e<=12e4&&e>0)},1e3);return()=>{r.forEach(e=>{document.removeEventListener(e,t)}),clearInterval(s)}},[e,l]),!e)return null;let c=e=>"".concat(Math.floor(e/6e4),":").concat(Math.floor(e%6e4/1e3).toString().padStart(2,"0")),m=t<=0?{color:"destructive",icon:b.Z,text:"Session abgelaufen",time:"0:00"}:n?{color:"secondary",icon:g.Z,text:"Session l\xe4uft ab",time:c(t)}:{color:"default",icon:p.Z,text:"Session aktiv",time:c(t)},u=m.icon;return!n&&t>12e4?null:(0,r.jsx)("div",{className:"fixed bottom-4 right-4 z-50",children:(0,r.jsx)(f.Zb,{className:"w-64 border-l-4 border-l-blue-500 shadow-lg",children:(0,r.jsx)(f.aY,{className:"p-3",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,r.jsx)(u,{className:"h-4 w-4 ".concat("destructive"===m.color?"text-red-600":"secondary"===m.color?"text-yellow-600":"text-green-600")})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:m.text}),(0,r.jsx)(x.C,{variant:m.color,className:"text-xs",children:m.time})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:n?"Interagieren Sie mit der Seite, um die Session zu verl\xe4ngern":"Automatische Abmeldung bei Inaktivit\xe4t"})]})]})})})})}var y=a(5526),N=a(7689),j=a(5805),w=a(4423),C=a(3781),S=a(6439),k=a(8420),Z=a(8906),A=a(8617);let E=[{name:"Datenimport",href:"/dashboard/data-import",icon:N.Z,subItems:[{name:"Daten hinzuf\xfcgen",href:"/dashboard/data-import"},{name:"Komplett neue Daten importieren",href:"/dashboard/data-import/new"},{name:"Automatisches synchronisieren",href:"/dashboard/data-import/auto"},{name:"\xdcbersichten & Statistiken",href:"/dashboard/data-import/stats"},{name:"KI-Zusammenfassung",href:"/dashboard/data-import/ai-insights"}]},{name:"Datenmanagement",href:"/dashboard/customers",icon:j.Z,subItems:[{name:"Alle Daten",href:"/dashboard/customers"},{name:"Nach Segmenten filtern",href:"/dashboard/customers/segments"},{name:"Kartenansicht nach Regionen",href:"/dashboard/customers/map"},{name:"Deduplizierungs-Regeln",href:"/dashboard/customers/deduplication"}]},{name:"Content Builder",href:"/dashboard/content",icon:w.Z,subItems:[{name:"Email Builder & Newsletter",href:"/dashboard/content"},{name:"WhatsApp Studio",href:"/dashboard/content/whatsapp"},{name:"SMS Builder",href:"/dashboard/content/sms"},{name:"Templates & Personalisierung",href:"/dashboard/content/templates"}]},{name:"Customer Journeys",href:"/dashboard/journeys",icon:C.Z,subItems:[{name:"\xdcbersichtsansicht",href:"/dashboard/journeys"},{name:"Journey erstellen",href:"/dashboard/journeys/create"},{name:"Journey bearbeiten",href:"/dashboard/journeys/edit"},{name:"KI-Zusammenfassung",href:"/dashboard/journeys/ai-insights"}]},{name:"Kampagnen",href:"/dashboard/campaigns",icon:S.Z,subItems:[{name:"\xdcbersichtsansicht",href:"/dashboard/campaigns"},{name:"Kampagne erstellen",href:"/dashboard/campaigns/create"},{name:"Kampagne bearbeiten",href:"/dashboard/campaigns/edit"},{name:"KI-Zusammenfassung",href:"/dashboard/campaigns/ai-insights"}]},{name:"Einstellungen",href:"/dashboard/settings",icon:o.Z,subItems:[{name:"\xdcbersicht",href:"/dashboard/settings"},{name:"Profil",href:"/dashboard/settings/profile"},{name:"Team & Berechtigungen",href:"/dashboard/settings/team"},{name:"Organisationen",href:"/dashboard/settings/organizations"},{name:"Benutzerverwaltung",href:"/dashboard/settings/users"},{name:"Benachrichtigungen",href:"/dashboard/settings/notifications"},{name:"Sicherheit",href:"/dashboard/settings/security"},{name:"Integrationen",href:"/dashboard/settings/integrations"}]}],I=[{name:"Organisationen",href:"/dashboard/admin/organizations",icon:k.Z,subItems:[{name:"Alle Organisationen",href:"/dashboard/admin/organizations"},{name:"Neue Organisation",href:"/dashboard/admin/organizations/new"}]},{name:"System-Verwaltung",href:"/dashboard/settings",icon:Z.Z,subItems:[{name:"Alle Benutzer",href:"/dashboard/settings/users"},{name:"System-Einstellungen",href:"/dashboard/settings/system"}]},{name:"Super Admin",href:"/dashboard/admin",icon:A.Z,subItems:[{name:"Dashboard",href:"/dashboard/admin"},{name:"Statistiken",href:"/dashboard/admin/stats"}]}];function z(e){let{children:t}=e,a=(0,n.useRouter)(),o=(0,n.usePathname)(),{user:l,loading:d,resetInactivityTimer:c}=(0,i.a)(),[m,u]=(0,s.useState)(null),[f,x]=(0,s.useState)(!1);if((0,s.useEffect)(()=>{d||l||a.push("/login")},[l,d,a]),(0,s.useEffect)(()=>{l&&c()},[o,l,c]),(0,s.useEffect)(()=>{(async()=>{if(null==l?void 0:l.email)try{let e=await (0,y.j5)(l.email);x(e);let t=await (0,y.Rg)(l.id);t.data&&u(t.data.role)}catch(e){console.error("Error checking permissions:",e)}})()},[l]),d)return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Anmeldung wird \xfcberpr\xfcft..."})]})});if(!l)return null;let b=(f?I:E).filter(e=>"Administration"!==e.name||f||"organization_admin"===m);console.log("Current pathname:",o);let g=o.endsWith("/")&&"/"!==o?o.slice(0,-1):o,p=b.find(e=>g===e.href||g.startsWith(e.href+"/"));console.log("Active nav item:",null==p?void 0:p.name);let N="/dashboard"===g,j="/dashboard/analytics"===g;return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsxs)("div",{className:"sticky top-0 z-50 bg-white shadow-sm border-b border-gray-200",children:[(0,r.jsx)("div",{className:"border-b border-gray-100",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)("button",{onClick:()=>a.push("/dashboard"),className:"text-xl font-bold text-gray-900 mr-8 hover:text-blue-600 transition-colors",children:"DATACRM"})}),(0,r.jsx)("nav",{className:"flex space-x-8 flex-1",children:b.map(e=>{let t=g===e.href||g.startsWith(e.href+"/"),s=e.icon;return(0,r.jsxs)("button",{onClick:()=>a.push(e.href),className:"flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors ".concat(t?"bg-blue-100 text-blue-700 border-b-2 border-blue-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:[(0,r.jsx)(s,{className:"mr-2 h-4 w-4"}),e.name]},e.name)})}),(0,r.jsx)("div",{className:"flex items-center space-x-4",children:(0,r.jsx)(h,{})})]})})}),(0,r.jsx)("div",{className:"bg-gray-50 border-b border-gray-200",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsx)("div",{className:"flex items-center h-12",children:(0,r.jsxs)("nav",{className:"flex space-x-6",children:[(N||j||!p)&&[{name:"Dashboard",href:"/dashboard"},{name:"Analytics/Statistiken",href:"/dashboard/analytics"}].map(e=>{let t=g===e.href;return(0,r.jsx)("button",{onClick:()=>a.push(e.href),className:"transition-colors px-3 py-2 rounded-md ".concat(t?"text-blue-700 font-semibold underline decoration-blue-700 decoration-2 text-xl":"text-gray-600 hover:text-gray-900 hover:bg-gray-100 text-sm"),children:e.name},e.name)}),p&&!N&&!j&&p.subItems.map(e=>{let t=g===e.href;return(0,r.jsx)("button",{onClick:()=>a.push(e.href),className:"transition-colors px-3 py-2 rounded-md ".concat(t?"text-blue-700 font-semibold underline decoration-blue-700 decoration-2 text-xl":"text-gray-600 hover:text-gray-900 hover:bg-gray-100 text-sm"),children:e.name},e.name)})]})})})})]}),(0,r.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:t}),(0,r.jsx)(v,{})]})}},9174:function(e,t,a){a.d(t,{C:function(){return o}});var r=a(7437);a(2265);var s=a(535),n=a(3448);let i=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:a,...s}=e;return(0,r.jsx)("div",{className:(0,n.cn)(i({variant:a}),t),...s})}},9820:function(e,t,a){a.d(t,{Ol:function(){return o},SZ:function(){return d},Zb:function(){return i},aY:function(){return c},ll:function(){return l}});var r=a(7437),s=a(2265),n=a(3448);let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});i.displayName="Card";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...s})});o.displayName="CardHeader";let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});l.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...s})});c.displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter"},3448:function(e,t,a){a.d(t,{cn:function(){return n}});var r=a(1994),s=a(3335);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,r.W)(t))}}}]);